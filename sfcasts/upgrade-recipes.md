# Flex Recipe Updates

When we install packages, many of them have recipes. These add new files, sometimes they modify existing files in a project. They do everything they need to to get that package set up and working immediately. Oftentimes, these packages over time will change. Maybe they add a new config line or change, as we'll see, a value in a configuration file. You don't need to. There is a recipe upgrade system. While you don't need to upgrade your recipes, they are the best way to keep your application looking and feeling modern, like a new application. They're also going to help us fix some of those deprecation warnings that we saw at the end of the previous chapter. Before you start upgrading recipes, make sure you've committed your changes. I already have, because the recipe upgrade system works using Git. To see your recipes, run Composer Recipes, and cool. It looks like we have about nine of them to update, so let's get to work. Composer Recipes, update. Updating recipes is one of my favorite things to do, because it gives us a chance to peek into the things that have been changing in these bundles while we've been busy, you know, doing our real job. I'll hit enter to just go down this list of one by one. So the first is from Doctrine Bundle, and this is one of the more complicated ones, and you can see it actually contains a conflict. One of my favorite features about the recipe update system is that sometimes the changes won't really make sense to us unless we can see the pull request behind them. And down here, you get a change log of all the pull requests that went into these specific things. So for example, this lazy ghosts thing, we can click here, we can actually see the pull request and some exclamation that goes behind what, why that was made. Now to see the changes, you can already see that the conflict is coming from Doctrine.yaml. And the specific thing is that this server version changed. Originally, Doctrine.yaml, Doctrine Bundle gave us configuration to work with Postgres version 13. They've now they're now shipped with Postgres version 16. You don't have to change that if your production is using Postgres 13, keep it. But I am going to change this to 16. Perfect.  And then over here, I'll run get status. I'll get add that. Then we can see all the changes by doing get diff dash dash cached. And you see most of them are exactly what I'm talking about. The MariaDB version changed. The MySQL version was changed from 5.7 to 8. The Postgres version was changed from 13 to 16. And then there are a couple other lines inside of Doctrine.yaml. And I'm not even going to go into these. These are all low level changes where you're opting into some low level change in the system. And you need to enable these. Now to opt into that new system, because these are all going to become automatic in the future. So for example, this report fields were declared, ops you into a slight change in how the mapping metadata is loaded, probably won't affect you. But you're opting into that here. And then you're going to be future proof. Same thing. In the docker-compose.yaml file, it also contains changes that go from Postgres 13 to 16. So again, you can keep these changes, or you can get rid of them. And then finally, at the bottom, we have symphony.lock, which just keeps track of what version of the recipe we have installed. So I'm going to commit these. And I'm going to use a really bad commit message just to move faster. You should do a better one. But there we go. Now to use the new version of Docker, I'm going to run docker-compose down. And then docker-compose up-d to bring to bring that back up. Cool. And that will actually start the new Postgres 16 version on your system. There's a good chance that it will have to download it. I already have that. Now to prove I'm using a brand new database over here, the homepage still works because it's not actually talking to the database. Don't forget browse mixes, all of a sudden it breaks this undefined table because we're using a brand new database. So let's fix that by running symphony-console-doctrine-migrations-migrate. Cool. And then symphony-console-doctrine-fixtures-load. Double cool. Back over here. Got it. Working. All right. Back to our terminal. And back to work. Composer recipes update. Next up is doctrine migrations bundle. I'm going to go through some of these a little bit quickly. This is very minor. It just changes. The bundle comes with a profiler integration.  It's actually this little icon right here. It's not super useful. And so it's changed to be not be enabled by default. And you can turn it back on if you want to. So let's commit that and update the next one, which is framework bundle. Framework bundle is symphony's core bundles. This is almost always one of the most important recipe updates. So I'll run git dit. But like doctrine, most of the changes here are just low level changes opting into a new system. So annotations are deprecated. So we're turning annotations off. Handle all throwables means that symphony will handle exceptions, but also errors that happen. This is a new mode that you should opt into. Storage factory ID. This is removed because that's the default value. And that's it. So it's a relatively easy one. So let's commit that. Keep going. Next one is monologue bundle. And this case is adding a little formatter key at the end of monologue.yaml. And you can see this if you follow the change log. This is just a small consistency thing. So down here for our production login configuration. The main log file for errors has this little JSON formatter there formats how and the deprecation log, this is the line that was added there just for consistency so that your logs always look the same whether it's an error or a deprecation. And we'll talk more about this deprecation error log pretty soon. So cool. So that one's easy. Welcome at that. Next is simply routing. And also a simple one, the this isn't config routes.yaml. This is the line that imports our attribute routes from our controllers. And this key is supposed to have a namespace key on it. And now we have it. So let's commit that. And on to symphony slash translation. And this is the easiest one yet. The translation.yaml comes with some providers you can use. And these were commented out before and they're just not there at all anymore. It's actually kind of a cool change. If you install these individual providers, then the configuration will be added here. But by default, just to keep your configuration file smaller. They're not there, they're empty. And that's the only change. So let's commit that down to the final two. Down to the final two.  And turns out these are both related to some changes with Webpack Encore and that new stimulus bundle, including a new Webpack Encore bundle major version. So these deserve their own chapter. So let's tackle them next.
