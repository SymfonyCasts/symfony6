WEBVTT

00:00:01.066 --> 00:00:06.236 align:middle
Conseguir que funcionen los archivos CSS de terceros es
una de las cosas más complicadas de hacer en AssetMapper.

00:00:06.686 --> 00:00:08.946 align:middle
Importarlos así no va a funcionar.

00:00:09.526 --> 00:00:11.276 align:middle
Centrémonos primero en Bootstrap.

00:00:11.746 --> 00:00:15.186 align:middle
Se trata de un paquete de terceros,
e instalamos paquetes de terceros

00:00:15.186 --> 00:00:18.636 align:middle
diciendo bin/console importmap:require
el nombre del paquete: Bootstrap

00:00:19.356 --> 00:00:23.536 align:middle
es especialmente interesante
porque coge el paquete JavaScript,

00:00:23.766 --> 00:00:27.436 align:middle
una dependencia del paquete JavaScript,
y también se ha dado cuenta

00:00:27.436 --> 00:00:30.186 align:middle
de que este paquete suele
tener un archivo CSS...

00:00:30.426 --> 00:00:32.296 align:middle
así que también lo coge.

00:00:32.806 --> 00:00:36.066 align:middle
Las tres cosas se añadieron a importmap.php.

00:00:36.066 --> 00:00:38.676 align:middle
No vamos a utilizar el JavaScript
de bootstrap en este proyecto.

00:00:38.816 --> 00:00:40.536 align:middle
Así que podríamos eliminarlo.

00:00:40.856 --> 00:00:43.166 align:middle
Pero lo dejaré porque no hace daño a nada.

00:00:43.826 --> 00:00:47.046 align:middle
La verdadera estrella, sin
embargo, es este archivo CSS.

00:00:47.556 --> 00:00:49.266 align:middle
Copia su ruta.

00:00:49.266 --> 00:00:52.236 align:middle
Y en app.css, elimina la línea superior.

00:00:52.856 --> 00:00:58.606 align:middle
Puedes importar CSS de terceros con AssetMapper, pero
no puedes hacerlo desde dentro de otro archivo CSS.

00:00:59.156 --> 00:01:03.776 align:middle
Bueno, técnicamente puedes, pero la vida
es más fácil si lo hacemos desde app.js.

00:01:03.776 --> 00:01:06.016 align:middle
Di import, y luego pega.

00:01:06.856 --> 00:01:07.716 align:middle
Y ahora...

00:01:08.326 --> 00:01:10.776 align:middle
¡Bootstrap cobra vida!

00:01:10.776 --> 00:01:12.236 align:middle
Lo siguiente es FontAwesome.

00:01:12.786 --> 00:01:16.576 align:middle
Fíjate en que estamos cogiendo un
archivo CSS específico del paquete.

00:01:17.216 --> 00:01:20.896 align:middle
Una gran diferencia entre Encore
y AssetMapper es que si necesitas

00:01:20.896 --> 00:01:24.836 align:middle
importar un archivo específico de un
paquete, tienes que importmap:require

00:01:24.836 --> 00:01:28.066 align:middle
ese archivo, no el paquete en general.

00:01:28.586 --> 00:01:35.736 align:middle
Mira bin/console importmap:require y
pega: Eso coge este único archivo CSS,

00:01:35.956 --> 00:01:40.236 align:middle
lo descarga en el proyecto y lo
añade a importmap.php justo aquí.

00:01:40.896 --> 00:01:45.506 align:middle
Si tienes curiosidad, estos archivos se
descargan en un directorio assets/vendor/.

00:01:46.126 --> 00:01:55.076 align:middle
Entra en app.css, elimina esa línea y
añade otra importación para esa ruta.

00:01:55.076 --> 00:01:57.006 align:middle
¡Y ya funciona!

00:01:57.386 --> 00:02:02.536 align:middle
Aunque, sobre el tema de FontAwesome,
ya no recomiendo usar FontAwesome así.

00:02:03.016 --> 00:02:05.626 align:middle
En su lugar, utiliza kits de FontAwesome.

00:02:06.066 --> 00:02:09.476 align:middle
O, mejor, renderiza un SVG en línea.

00:02:09.476 --> 00:02:14.036 align:middle
Esperemos que pronto tengamos un paquete de iconos
de Symfony UX para que esto sea más fácil.

00:02:14.716 --> 00:02:17.606 align:middle
El último elemento en app.css es una fuente.

00:02:18.016 --> 00:02:19.546 align:middle
Esto es más complicado.

00:02:20.076 --> 00:02:25.396 align:middle
Si ejecutamos importmap:require seguido
sólo de un nombre de paquete -sin ruta-,

00:02:25.396 --> 00:02:28.766 align:middle
siempre descargará el archivo
JavaScript principal del paquete.

00:02:29.296 --> 00:02:35.676 align:middle
Sólo obtendrá un archivo CSS si importmap:require
una ruta a un archivo CSS, como acabamos de hacer.

00:02:36.546 --> 00:02:42.196 align:middle
Vale, ya sé que antes ejecutamos import:require
bootstrap y eso sí nos dio un archivo CSS.

00:02:42.546 --> 00:02:44.286 align:middle
Permíteme ser más claro.

00:02:44.286 --> 00:02:49.736 align:middle
Si ejecutas importmap:require packageName,
obtendrás el JavaScript de ese paquete.

00:02:50.296 --> 00:02:56.036 align:middle
En algunos casos, como Bootstrap, el
paquete anuncia que tiene un archivo CSS.

00:02:56.586 --> 00:03:00.556 align:middle
Cuando eso ocurre, AssetMapper
lo ve y, efectivamente, ejecuta

00:03:00.556 --> 00:03:05.536 align:middle
importmap:require
bootstrap/dist/css/bootstrap.min.css

00:03:05.536 --> 00:03:06.286 align:middle
automáticamente...

00:03:06.526 --> 00:03:07.556 align:middle
sólo para ser útil.

00:03:08.356 --> 00:03:10.536 align:middle
De todos modos, sé que
necesitamos un archivo CSS.

00:03:11.116 --> 00:03:15.246 align:middle
Con Encore, si importabas un paquete
desde dentro de un archivo CSS,

00:03:15.596 --> 00:03:19.546 align:middle
Encore intentaba encontrar el archivo
CSS en el paquete e importarlo.

00:03:20.116 --> 00:03:24.876 align:middle
Esto no ocurre con AssetMapper: tenemos que
averiguar cuál es la ruta al archivo CSS

00:03:24.876 --> 00:03:27.806 align:middle
y, a continuación, solicitarlo.

00:03:28.416 --> 00:03:30.896 align:middle
Me gusta hacer esto en jsDelivr.com.

00:03:31.356 --> 00:03:35.566 align:middle
Esta es la CDN que AssetMapper utiliza
entre bastidores para obtener paquetes.

00:03:35.566 --> 00:03:37.216 align:middle
Busca el paquete.

00:03:38.056 --> 00:03:42.006 align:middle
Aparecerá, pero hay uno más
abajo de @fontsource-variable.

00:03:42.546 --> 00:03:46.386 align:middle
Las fuentes variables pueden ser un poco
más eficientes, así que cambiemos a eso.

00:03:47.096 --> 00:03:48.736 align:middle
Dentro, ¡eh!

00:03:48.926 --> 00:03:51.186 align:middle
¡Anuncia el archivo CSS principal!

00:03:51.186 --> 00:03:54.846 align:middle
Si quisieras un archivo diferente,
podrías hacer clic en la pestaña Archivos

00:03:54.846 --> 00:03:56.416 align:middle
y navegar hasta encontrar lo que necesitas.

00:03:57.346 --> 00:04:01.316 align:middle
Copia esta ruta hasta el
nombre del paquete, luego gira

00:04:01.316 --> 00:04:04.276 align:middle
y ejecuta importmap:require y pega.

00:04:04.716 --> 00:04:10.776 align:middle
Pero no necesitamos la versión: sólo el
paquete y luego la ruta: Cópiala y pulsa intro.

00:04:11.886 --> 00:04:16.726 align:middle
Descarga el archivo CSS y añade
una entrada a importmap.php.

00:04:16.726 --> 00:04:21.776 align:middle
Por último, elimina la importación
de app.css e impórtala de app.js.

00:04:23.656 --> 00:04:26.906 align:middle
Ah, y como hemos cambiado a la
fuente variable, en app.css,

00:04:26.906 --> 00:04:30.856 align:middle
actualiza la familia de fuentes
a Roboto Condensed Variable.

00:04:31.526 --> 00:04:34.386 align:middle
En el sitio, observa la
fuente cuando actualice.

00:04:35.236 --> 00:04:40.366 align:middle
Ya está Coger esos archivos CSS de terceros
puede ser lo más complicado que hagas

00:04:40.366 --> 00:04:41.166 align:middle
en AssetMapper.

00:04:41.766 --> 00:04:45.636 align:middle
Ah, y si utilizas Sass o Tailwind,
hay bundles de Symfonycasts

00:04:45.636 --> 00:04:47.836 align:middle
compatibles con ambos en AssetMapper.

00:04:48.516 --> 00:04:51.956 align:middle
Ahora que el estilo está funcionando,
echemos un vistazo a nuestro JavaScript.

00:04:52.576 --> 00:04:57.216 align:middle
En la consola, tenemos un error:
un 404 para algo llamado bootstrap.

00:04:57.746 --> 00:05:00.896 align:middle
Eso viene de app.js: de
esta línea de importación.

00:05:01.646 --> 00:05:06.616 align:middle
Para solucionarlo, abre
app.js y añade .js al final.

00:05:07.186 --> 00:05:11.276 align:middle
Con Webpack Encore, estamos
ejecutando dentro de un entorno Node.

00:05:11.626 --> 00:05:16.546 align:middle
Y Node te permite hacer trampas: si el
archivo que estás importando termina en .js,

00:05:16.756 --> 00:05:18.986 align:middle
no necesitas incluir el .js.

00:05:19.356 --> 00:05:25.536 align:middle
Pero en un entorno JavaScript real, como tu
navegador, no puedes hacer eso: el .js es necesario.

00:05:25.536 --> 00:05:29.396 align:middle
Éste es probablemente el mayor cambio
que tendrás que hacer al convertir.

00:05:30.186 --> 00:05:31.036 align:middle
Prueba la página ahora.

00:05:32.216 --> 00:05:33.166 align:middle
¡Siguiente error!

00:05:33.616 --> 00:05:39.846 align:middle
Y es importante: Fallo al resolver el
especificador de módulo @symfony/stimulus-bridge.

00:05:40.526 --> 00:05:44.176 align:middle
Esto significa que, en algún lugar,
estamos importando este paquete...

00:05:44.406 --> 00:05:48.416 align:middle
pero el paquete no existe en importmap.php.

00:05:48.416 --> 00:05:50.066 align:middle
Hay dos tipos de importaciones.

00:05:50.066 --> 00:05:53.966 align:middle
En primer lugar, si una
importación empieza por ./

00:05:53.966 --> 00:05:56.176 align:middle
o ../, es una importación relativa. Éstas

00:05:56.716 --> 00:06:00.266 align:middle
son sencillas: estás importando
un archivo junto a este archivo. El

00:06:00.826 --> 00:06:03.216 align:middle
segundo tipo se llama importación desnuda. Es

00:06:03.846 --> 00:06:07.796 align:middle
cuando importas un paquete o un
archivo dentro de un paquete. En

00:06:07.796 --> 00:06:13.806 align:middle
estos casos, la cadena dentro de la importación debe
existir exactamente en importmap.php. Si no es así

00:06:13.806 --> 00:06:16.436 align:middle
, verás este error. La

00:06:16.956 --> 00:06:19.806 align:middle
fuente de nuestro error es bootstrap.js. ¿Ves

00:06:19.806 --> 00:06:22.606 align:middle
este @symfony/stimulus-bridge ?

00:06:23.016 --> 00:06:26.426 align:middle
No existe en importmap.php. La

00:06:26.426 --> 00:06:29.606 align:middle
solución, normalmente, es instalarlo. Pero

00:06:29.966 --> 00:06:33.226 align:middle
en este caso, el paquete es
específico de Webpack Encore y

00:06:33.526 --> 00:06:35.596 align:middle
la solución está relacionada
con nuestra migración. Cámbialo

00:06:36.156 --> 00:06:39.076 align:middle
a @symfony/stimulus-bundle. Y

00:06:40.276 --> 00:06:45.966 align:middle
he aquí: ¡esa cadena sí vive dentro
de importmap.php ! A continuación,

00:06:45.966 --> 00:06:48.186 align:middle
la siguiente línea se simplifica. Pero

00:06:48.466 --> 00:06:52.976 align:middle
hace lo mismo que antes: inicia la aplicación
Stimulus y carga nuestros controladores. Si inicias

00:06:52.976 --> 00:06:57.206 align:middle
una nueva app Symfony, obtendrás
todo esto con la receta. Pero

00:06:57.656 --> 00:07:00.336 align:middle
como estamos convirtiendo, necesitamos
hacer un poco más de trabajo. Actualiza

00:07:00.336 --> 00:07:01.976 align:middle
ahora.

00:07:02.686 --> 00:07:06.676 align:middle
Obtenemos exactamente el mismo error
pero con un paquete diferente: axios.

00:07:07.166 --> 00:07:10.716 align:middle
Ya sabes lo que pasa: en algún
sitio, estamos importando esto... pero

00:07:10.956 --> 00:07:13.666 align:middle
no vive en importmap.php. En

00:07:13.666 --> 00:07:16.996 align:middle
este caso, procede de
song-controls_controller.js. Y

00:07:18.026 --> 00:07:21.336 align:middle
esta vez, ¡la solución es
instalar este paquete! Gira

00:07:21.336 --> 00:07:25.656 align:middle
y ejecuta php bin/console
importmap:require axios Eso

00:07:26.116 --> 00:07:29.706 align:middle
añade axios a importmap.php
y ahora... ¡nuestra

00:07:30.016 --> 00:07:32.046 align:middle
aplicación está viva! ¡ Esto

00:07:32.556 --> 00:07:34.206 align:middle
funciona con AssetMapper!

00:07:34.586 --> 00:07:39.006 align:middle
Tenemos un frontend moderno y eficaz,
todo ello sin sistema de compilación. Ah,

00:07:39.676 --> 00:07:43.936 align:middle
pero mira el pie de página: el texto es
más oscuro que antes. Antes utilizaba

00:07:44.516 --> 00:07:46.966 align:middle
bootstrap 5.1. Pero

00:07:47.466 --> 00:07:51.936 align:middle
cuando instalamos bootstrap con
AssetMapper, cogió la última 5.3. Y , al

00:07:52.446 --> 00:07:54.546 align:middle
parecer, ¡algo cambió!

00:07:55.126 --> 00:07:57.576 align:middle
Podría averiguar qué ha
cambiado y solucionarlo... Pero

00:07:57.886 --> 00:07:59.366 align:middle
también podemos hacer un downgrade. Actualizar

00:08:00.066 --> 00:08:04.316 align:middle
la versión en importmap.php a 5.1.3. Si

00:08:06.386 --> 00:08:09.656 align:middle
hiciéramos eso y actualizáramos,
nada cambiaría: la

00:08:09.956 --> 00:08:13.636 align:middle
versión más reciente se sigue
descargando en assets/vendor/. Para

00:08:14.286 --> 00:08:20.296 align:middle
sincronizar ese directorio con importmap.php,
ejecuta: php bin/console importmap:install Piensa que

00:08:20.296 --> 00:08:23.586 align:middle
esto es como el composer install
del mundo de AssetMapper. Se ha

00:08:24.186 --> 00:08:28.006 align:middle
dado cuenta de que hemos cambiado dos
paquetes y los ha descargado. Y así de fácil

00:08:29.096 --> 00:08:31.996 align:middle
, ¡hemos cruzado la línea de meta! ¡ Estamos

00:08:32.326 --> 00:08:34.246 align:middle
ejecutando AssetMapper!
A continuación, vamos a

00:08:34.926 --> 00:08:39.476 align:middle
dedicar tres minutos a modernizar
y simplificar nuestro JavaScript.
